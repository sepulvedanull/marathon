{"version":3,"sources":["../server/index.js"],"names":["bodyParser","require","path","favicon","logger","cookieParser","express","fs","debug","http","app","router","Router","port","normalizePort","process","env","PORT","set","server","createServer","listen","on","onError","onListening","use","json","urlencoded","extended","static","join","__dirname","req","res","next","err","Error","status","get","render","title","header","dataPath","params","year","race","existsSync","send","data","val","parseInt","isNaN","error","syscall","bind","code","console","exit","addr","address","module","exports"],"mappings":"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","file":"index.js","sourcesContent":["var bodyParser = require(\"body-parser\");\nvar path = require('path');\nvar favicon = require('serve-favicon');\nvar logger = require('morgan');\nvar cookieParser = require('cookie-parser');\nvar express = require('express');\nvar fs = require('fs');\nvar debug = require('debug')('myapp:server');\nvar http = require('http');\nvar app = express();\nvar router = express.Router();\n\nvar port = normalizePort(process.env.PORT || '8080');\napp.set('port', port);\n\nvar server = http.createServer(app);\n\nserver.listen(port);\nserver.on('error', onError);\nserver.on('listening', onListening);\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({extended: false}));\n\napp.use(logger('dev'));\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({extended: false}));\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, './')));\napp.set('view engine', 'pug');\napp.set('views', path.join(__dirname, './'));\n// catch 404 and forward to error handler\napp.use(function (req, res, next) {\n  var err = new Error('Not Found');\n  err.status = 404;\n  next(err);\n});\n\n/* GET home page. */\napp.get('/', function (req, res, next) {\n  res.render('index', {title: 'Express'});\n});\n\napp.get(\"/api/:year/:race\", function (req, res) {\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n\n  var dataPath = './data-scraper/data/' + req.params.year + '/' + req.params.race + '.json';\n\n  if (!fs.existsSync(dataPath)) {\n    res.status(422).send(\"Data file does not exist\");\n  } else {\n    var data = require(dataPath);\n    res.status(200).send(data);\n  }\n});\n\n/**\n * Normalize a port into a number, string, or false.\n */\nfunction normalizePort (val) {\n  var port = parseInt(val, 10);\n  if (isNaN(port)) { return val; }\n  if (port >= 0) { return port; }\n  return false;\n}\n\n/**\n * Event listener for HTTP server \"error\" event.\n */\nfunction onError (error) {\n  if (error.syscall !== 'listen') {throw error;}\n\n  var bind = typeof port === 'string'\n    ? 'Pipe ' + port\n    : 'Port ' + port;\n\n  // handle specific listen errors with friendly messages\n  switch (error.code) {\n    case 'EACCES':\n      console.error(bind + ' requires elevated privileges');\n      process.exit(1);\n      break;\n    case 'EADDRINUSE':\n      console.error(bind + ' is already in use');\n      process.exit(1);\n      break;\n    default:\n      throw error;\n  }\n}\n\n/**\n * Event listener for HTTP server \"listening\" event.\n */\nfunction onListening () {\n  var addr = server.address();\n  var bind = typeof addr === 'string'\n    ? 'pipe ' + addr\n    : 'port ' + addr.port;\n  debug('Listening on ' + bind);\n}\n\nmodule.exports = app;"]}